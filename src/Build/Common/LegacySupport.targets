<!--
  LegacySupport.targets - Polyfill and extension injection

  Injects shared source files into projects based on:
  1. The properties set in the project (InjectXxx)
  2. The target framework (only inject when needed)
-->
<Project>
  <!-- ═══════════════════════════════════════════════════════════════════════
       BUNDLE EXPANSION
       Must be in .targets to run AFTER project PropertyGroups set their values.
       This allows user to set InjectAllPolyfillsOnLegacy=true in their project.
       ═══════════════════════════════════════════════════════════════════════ -->
  <PropertyGroup Condition="'$(InjectAllPolyfillsOnLegacy)' == 'true'">
    <InjectTrimAttributesOnLegacy>true</InjectTrimAttributesOnLegacy>
    <InjectNullabilityAttributesOnLegacy>true</InjectNullabilityAttributesOnLegacy>
    <InjectIsExternalInitOnLegacy>true</InjectIsExternalInitOnLegacy>
    <InjectRequiredMemberOnLegacy>true</InjectRequiredMemberOnLegacy>
    <InjectSetsRequiredMembersOnLegacy>true</InjectSetsRequiredMembersOnLegacy>
    <InjectCallerAttributesOnLegacy>true</InjectCallerAttributesOnLegacy>
    <InjectCompilerFeatureRequiredOnLegacy>true</InjectCompilerFeatureRequiredOnLegacy>
    <InjectUnreachableExceptionOnLegacy>true</InjectUnreachableExceptionOnLegacy>
    <InjectExperimentalAttributeOnLegacy>true</InjectExperimentalAttributeOnLegacy>
    <InjectIndexRangeOnLegacy>true</InjectIndexRangeOnLegacy>
    <InjectStackTraceHiddenOnLegacy>true</InjectStackTraceHiddenOnLegacy>
    <InjectLockPolyfill>true</InjectLockPolyfill>
    <InjectTimeProviderPolyfill>true</InjectTimeProviderPolyfill>
    <InjectStringExtensionsPolyfill>true</InjectStringExtensionsPolyfill>
    <InjectANcpLuaDiagnosticsPolyfills>true</InjectANcpLuaDiagnosticsPolyfills>
    <InjectANcpLuaExceptionPolyfills>true</InjectANcpLuaExceptionPolyfills>
    <InjectANcpLuaExperimentalPolyfills>true</InjectANcpLuaExperimentalPolyfills>
    <InjectANcpLuaIndexRangePolyfills>true</InjectANcpLuaIndexRangePolyfills>
    <InjectANcpLuaLanguageFeaturesPolyfills>true</InjectANcpLuaLanguageFeaturesPolyfills>
    <InjectANcpLuaNullabilityPolyfills>true</InjectANcpLuaNullabilityPolyfills>
    <InjectANcpLuaRangePolyfill>true</InjectANcpLuaRangePolyfill>
    <InjectANcpLuaTimeProviderPolyfill>true</InjectANcpLuaTimeProviderPolyfill>
    <InjectANcpLuaTrimAttributesPolyfills>true</InjectANcpLuaTrimAttributesPolyfills>
  </PropertyGroup>

  <PropertyGroup Condition="'$(InjectAllExtensions)' == 'true'">
    <InjectSharedThrow>true</InjectSharedThrow>
    <InjectSourceGenHelpers>true</InjectSourceGenHelpers>
    <InjectCommonComparers>true</InjectCommonComparers>
    <EnableANcpLuaExtensions>true</EnableANcpLuaExtensions>
    <EnableANcpLuaSharedResources>true</EnableANcpLuaSharedResources>
    <EnableANcpLuaSharedWorkflows>true</EnableANcpLuaSharedWorkflows>
    <InjectANcpLuaIntegrationTestHelpers>true</InjectANcpLuaIntegrationTestHelpers>
  </PropertyGroup>

  <!-- InjectAllLanguageFeaturePolyfills - All C# 14 language feature polyfills for netstandard2.0 -->
  <PropertyGroup Condition="'$(InjectAllLanguageFeaturePolyfills)' == 'true'">
    <InjectIsExternalInitOnLegacy>true</InjectIsExternalInitOnLegacy>
    <InjectRequiredMemberOnLegacy>true</InjectRequiredMemberOnLegacy>
    <InjectSetsRequiredMembersOnLegacy>true</InjectSetsRequiredMembersOnLegacy>
    <InjectCallerAttributesOnLegacy>true</InjectCallerAttributesOnLegacy>
    <InjectCompilerFeatureRequiredOnLegacy>true</InjectCompilerFeatureRequiredOnLegacy>
    <InjectParamCollectionOnLegacy>true</InjectParamCollectionOnLegacy>
    <InjectIndexRangeOnLegacy>true</InjectIndexRangeOnLegacy>
    <InjectNullabilityAttributesOnLegacy>true</InjectNullabilityAttributesOnLegacy>
  </PropertyGroup>

  <!-- Enable dependencies for SharedThrow -->
  <PropertyGroup Condition="'$(InjectSharedThrow)' == 'true'">
    <InjectCallerAttributesOnLegacy>true</InjectCallerAttributesOnLegacy>
    <InjectNullabilityAttributesOnLegacy>true</InjectNullabilityAttributesOnLegacy>
  </PropertyGroup>

  <!-- ═══════════════════════════════════════════════════════════════════════
       TFM DETECTION HELPERS
       ═══════════════════════════════════════════════════════════════════════ -->
  <PropertyGroup>
    <!-- Parse TFM directly using MSBuild functions (works before TargetFrameworkIdentifier is set) -->
    <_TfmId>$([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)'))</_TfmId>
    <_TfmVersion Condition="'$(_TfmId)' == '.NETCoreApp'">$([MSBuild]::GetTargetFrameworkVersion('$(TargetFramework)').TrimStart('v'))</_TfmVersion>
    <_TfmVersion Condition="'$(_TfmVersion)' == ''">0.0</_TfmVersion>

    <!-- One-liners: true = type MISSING from framework -->
    <_NeedsNetCoreApp31Polyfills Condition="$([MSBuild]::VersionLessThan('$(_TfmVersion)', '3.1'))">true</_NeedsNetCoreApp31Polyfills>
    <_NeedsNet5Polyfills Condition="$([MSBuild]::VersionLessThan('$(_TfmVersion)', '5.0'))">true</_NeedsNet5Polyfills>
    <_NeedsNet6Polyfills Condition="$([MSBuild]::VersionLessThan('$(_TfmVersion)', '6.0'))">true</_NeedsNet6Polyfills>
    <_NeedsNet7Polyfills Condition="$([MSBuild]::VersionLessThan('$(_TfmVersion)', '7.0'))">true</_NeedsNet7Polyfills>
    <_NeedsNet8Polyfills Condition="$([MSBuild]::VersionLessThan('$(_TfmVersion)', '8.0'))">true</_NeedsNet8Polyfills>
    <_NeedsNet9Polyfills Condition="$([MSBuild]::VersionLessThan('$(_TfmVersion)', '9.0'))">true</_NeedsNet9Polyfills>

    <!-- Shared folder path -->
    <_SharedSourcePath>$(MSBuildThisFileDirectory)../../shared/</_SharedSourcePath>
  </PropertyGroup>

  <Target Name="DebugLegacySupport" BeforeTargets="CoreCompile" Condition="'$(ANcpLuaDebugLegacySupport)' == 'true'">
    <Message Importance="High" Text="LegacySupport: InjectANcpLuaLanguageFeaturesPolyfills = $(InjectANcpLuaLanguageFeaturesPolyfills)"/>
    <Message Importance="High" Text="LegacySupport: _NeedsNet5Polyfills = $(_NeedsNet5Polyfills)"/>
    <Message Importance="High" Text="LegacySupport: _SharedSourcePath = $(_SharedSourcePath)"/>
  </Target>

  <!-- ═══════════════════════════════════════════════════════════════════════
       POLYFILLS - BCL Types for Older TFMs
       ═══════════════════════════════════════════════════════════════════════ -->

  <!-- ─────────────────────────────────────────────────────────────────────────
       TRIM ATTRIBUTES (< net5.0)
       RequiresUnreferencedCodeAttribute, RequiresDynamicCodeAttribute,
       DynamicallyAccessedMembersAttribute, UnconditionalSuppressMessageAttribute
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="('$(InjectTrimAttributesOnLegacy)' == 'true' OR '$(InjectANcpLuaTrimAttributesPolyfills)' == 'true') AND '$(_NeedsNet5Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/TrimAttributes/*.cs" LinkBase="Shared/Polyfills/TrimAttributes" Visible="false"/>
  </ItemGroup>

  <!-- RequiresDynamicCodeAttribute came in net7.0 -->
  <ItemGroup Condition="('$(InjectTrimAttributesOnLegacy)' == 'true' OR '$(InjectANcpLuaTrimAttributesPolyfills)' == 'true') AND '$(_NeedsNet7Polyfills)' == 'true' AND '$(_NeedsNet5Polyfills)' != 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/TrimAttributes/RequiresDynamicCodeAttribute.cs" LinkBase="Shared/Polyfills/TrimAttributes" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       NULLABILITY ATTRIBUTES (< netcoreapp3.1)
       AllowNull, DisallowNull, MaybeNull, NotNull, DoesNotReturn, etc.
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="('$(InjectNullabilityAttributesOnLegacy)' == 'true' OR '$(InjectANcpLuaNullabilityPolyfills)' == 'true') AND '$(_NeedsNetCoreApp31Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/DiagnosticAttributes/NullableAttributes.cs" LinkBase="Shared/Polyfills/NullabilityAttributes" Visible="false"/>
  </ItemGroup>

  <!-- MemberNotNull/MemberNotNullWhen came in net5.0 (always include if enabled, has #if guards) -->
  <ItemGroup Condition="('$(InjectNullabilityAttributesOnLegacy)' == 'true' OR '$(InjectANcpLuaNullabilityPolyfills)' == 'true') AND '$(_NeedsNet5Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/NullabilityAttributes/MemberNotNullAttributes.cs" LinkBase="Shared/Polyfills/NullabilityAttributes" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       LANGUAGE FEATURES
       ───────────────────────────────────────────────────────────────────────── -->

  <!-- IsExternalInit (< net5.0) - enables records -->
  <ItemGroup Condition="('$(InjectIsExternalInitOnLegacy)' == 'true' OR '$(InjectANcpLuaLanguageFeaturesPolyfills)' == 'true') AND '$(_NeedsNet5Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/LanguageFeatures/IsExternalInit.cs" LinkBase="Shared/Polyfills/LanguageFeatures" Visible="false"/>
  </ItemGroup>

  <!-- RequiredMemberAttribute (< net7.0) - enables 'required' keyword -->
  <ItemGroup Condition="('$(InjectRequiredMemberOnLegacy)' == 'true' OR '$(InjectANcpLuaLanguageFeaturesPolyfills)' == 'true') AND '$(_NeedsNet7Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/LanguageFeatures/RequiredMemberAttribute.cs" LinkBase="Shared/Polyfills/LanguageFeatures" Visible="false"/>
  </ItemGroup>

  <!-- CompilerFeatureRequiredAttribute (< net7.0) - required for 'required' keyword -->
  <ItemGroup Condition="('$(InjectCompilerFeatureRequiredOnLegacy)' == 'true' OR '$(InjectANcpLuaLanguageFeaturesPolyfills)' == 'true') AND '$(_NeedsNet7Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/LanguageFeatures/CompilerFeatureRequiredAttribute.cs" LinkBase="Shared/Polyfills/LanguageFeatures" Visible="false"/>
  </ItemGroup>

  <!-- SetsRequiredMembersAttribute (< net7.0) - allows constructors to satisfy required members -->
  <ItemGroup Condition="('$(InjectSetsRequiredMembersOnLegacy)' == 'true' OR '$(InjectANcpLuaLanguageFeaturesPolyfills)' == 'true') AND '$(_NeedsNet7Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/LanguageFeatures/SetsRequiredMembersAttribute.cs" LinkBase="Shared/Polyfills/LanguageFeatures" Visible="false"/>
  </ItemGroup>

  <!-- CallerArgumentExpressionAttribute (< net6.0) -->
  <ItemGroup Condition="('$(InjectCallerAttributesOnLegacy)' == 'true' OR '$(InjectANcpLuaLanguageFeaturesPolyfills)' == 'true') AND '$(_NeedsNet6Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/LanguageFeatures/CallerArgumentExpressionAttribute.cs" LinkBase="Shared/Polyfills/LanguageFeatures" Visible="false"/>
  </ItemGroup>

  <!-- Index and Range (< netcoreapp3.0 / netstandard2.1) - enables arr[^1], arr[1..3] -->
  <!-- These have #if guards: !NETCOREAPP3_0_OR_GREATER && !NETSTANDARD2_1_OR_GREATER -->
  <ItemGroup Condition="('$(InjectIndexRangeOnLegacy)' == 'true' OR '$(InjectANcpLuaIndexRangePolyfills)' == 'true') AND '$(_NeedsNetCoreApp31Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/IndexRange/Index.cs" LinkBase="Shared/Polyfills/IndexRange" Visible="false"/>
    <Compile Include="$(_SharedSourcePath)Polyfills/IndexRange/Range.cs" LinkBase="Shared/Polyfills/IndexRange" Visible="false"/>
  </ItemGroup>

  <!-- ParamCollectionAttribute (< net9.0) - enables C# 13 params collections -->
  <ItemGroup Condition="('$(InjectParamCollectionOnLegacy)' == 'true' OR '$(InjectANcpLuaLanguageFeaturesPolyfills)' == 'true') AND '$(_NeedsNet9Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/LanguageFeatures/ParamCollectionAttribute.cs" LinkBase="Shared/Polyfills/LanguageFeatures" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       EXCEPTIONS (< net7.0)
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="('$(InjectUnreachableExceptionOnLegacy)' == 'true' OR '$(InjectANcpLuaExceptionPolyfills)' == 'true') AND '$(_NeedsNet7Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/Exceptions/UnreachableException.cs" LinkBase="Shared/Polyfills/Exceptions" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       EXPERIMENTAL (< net8.0)
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="('$(InjectExperimentalAttributeOnLegacy)' == 'true' OR '$(InjectANcpLuaExperimentalPolyfills)' == 'true') AND '$(_NeedsNet8Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/Experimental/ExperimentalAttribute.cs" LinkBase="Shared/Polyfills/Experimental" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       DIAGNOSTICS (< net6.0)
       StackTraceHiddenAttribute
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectDiagnosticClassesOnLegacy)' == 'true' AND ('$(TargetFramework)' == 'netstandard2.0' OR '$(TargetFramework)' == 'net472')">
    <Compile Include="$(_SharedSourcePath)Polyfills/DiagnosticClasses.cs" LinkBase="Shared/Polyfills" Visible="false"/>
  </ItemGroup>

  <ItemGroup Condition="('$(InjectStackTraceHiddenOnLegacy)' == 'true' OR '$(InjectANcpLuaDiagnosticsPolyfills)' == 'true') AND '$(_NeedsNet6Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/Diagnostics/StackTraceHiddenAttribute.cs" LinkBase="Shared/Polyfills/Diagnostics" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       EXTENSIONS - Utility Types (All TFMs)
       ═══════════════════════════════════════════════════════════════════════ -->

  <!-- ─────────────────────────────────────────────────────────────────────────
       THROW / GUARD CLAUSES
       Microsoft.Shared.Diagnostics.Throw
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectSharedThrow)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Throw/Throw.cs" LinkBase="Shared/Throw" Visible="false"/>
    <Using Include="Microsoft.Shared.Diagnostics"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       FAKE LOGGER
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectFakeLogger)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Extensions/FakeLogger/FakeLoggerExtensions.cs" LinkBase="Shared/Extensions/FakeLogger" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       INTEGRATION TESTS
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectANcpLuaIntegrationTestHelpers)' == 'true'">
    <Compile Include="$(_SharedSourcePath)IntegrationTests/*.cs" LinkBase="Shared/IntegrationTests" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       SOURCE GENERATOR HELPERS
       Base utilities (EquatableArray<T>, DiagnosticInfo, etc.) from source-only package
       SDK-specific extensions (DiagnosticsExtensions, SyntaxValueProvider) embedded in SDK
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectSourceGenHelpers)' == 'true'">
    <PackageReference Include="ANcpLua.Roslyn.Utilities.Sources" Version="$(ANcpLuaRoslynUtilitiesSourcesVersion)" VersionOverride="$(ANcpLuaRoslynUtilitiesSourcesVersion)" PrivateAssets="all" IsImplicitlyDefined="true"/>
    <!-- SDK-specific extensions that build on ANcpLua.Roslyn.Utilities -->
    <Compile Include="$(_SharedSourcePath)Extensions/SourceGen/DiagnosticsExtensions.cs" LinkBase="Shared/Extensions/SourceGen" Visible="false"/>
    <Compile Include="$(_SharedSourcePath)Extensions/SourceGen/SyntaxValueProvider.cs" LinkBase="Shared/Extensions/SourceGen" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       CODE FIX HELPERS
       CodeFixProviderBase<TSyntax> - base class for code fixes
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectCodeFixProviderBase)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Extensions/CodeFixes/CodeFixProviderBase.cs" LinkBase="Shared/Extensions/CodeFixes" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       SYNTAX MODIFIER EXTENSIONS
       SyntaxModifierExtensions - helpers for manipulating modifiers in code fixes
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectSyntaxModifierExtensions)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Extensions/SyntaxModifier/SyntaxModifierExtensions.cs" LinkBase="Shared/Extensions/SyntaxModifier" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       COMMON COMPARERS
       StringOrdinalComparer
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectCommonComparers)' == 'true' OR '$(InjectStringOrdinalComparer)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Extensions/Comparers/*.cs" LinkBase="Shared/Extensions/Comparers" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       POLYFILLS - Lock & TimeProvider
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectLockPolyfill)' == 'true' AND '$(_NeedsNet9Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/Lock.cs" LinkBase="Shared/Polyfills" Visible="false"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       STRING EXTENSIONS (< netcoreapp2.1 / netstandard2.1)
       Contains(string, StringComparison), Replace(string, string, StringComparison),
       Contains(char), IndexOf(char, StringComparison)
       Fixes CA1307 and CA2249 compliance on netstandard2.0
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(InjectStringExtensionsPolyfill)' == 'true' AND '$(_NeedsNetCoreApp31Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/StringExtensions/StringExtensions.cs" LinkBase="Shared/Polyfills/StringExtensions" Visible="false"/>
  </ItemGroup>

  <ItemGroup Condition="('$(InjectTimeProviderPolyfill)' == 'true' OR '$(InjectANcpLuaTimeProviderPolyfill)' == 'true') AND '$(_NeedsNet8Polyfills)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Polyfills/TimeProvider/TimeProvider.cs" LinkBase="Shared/Polyfills" Visible="false"/>
    <!-- TimeProvider on legacy frameworks requires IAsyncDisposable and ValueTask -->
    <PackageReference Include="Microsoft.Bcl.AsyncInterfaces" Version="$(BclAsyncInterfacesVersion)" VersionOverride="$(BclAsyncInterfacesVersion)" Condition="'$(TargetFramework)' == 'netstandard2.0' or '$(TargetFramework)' == 'net462'" IsImplicitlyDefined="true"/>
    <PackageReference Include="System.Threading.Tasks.Extensions" Version="$(TasksExtensionsVersion)" VersionOverride="$(TasksExtensionsVersion)" Condition="'$(TargetFramework)' == 'netstandard2.0' or '$(TargetFramework)' == 'net462'" IsImplicitlyDefined="true"/>
  </ItemGroup>

  <!-- ─────────────────────────────────────────────────────────────────────────
       WORKFLOWS
       ───────────────────────────────────────────────────────────────────────── -->
  <ItemGroup Condition="'$(EnableANcpLuaSharedWorkflows)' == 'true'">
    <Compile Include="$(_SharedSourcePath)Workflows/**/*.cs" LinkBase="Shared/Workflows" Visible="false"/>
  </ItemGroup>

  <!-- ═══════════════════════════════════════════════════════════════════════
       BINLOG EMBEDDING (for diagnostics)
       ═══════════════════════════════════════════════════════════════════════ -->
  <Target Name="EmbedSharedSourcesInBinLog" AfterTargets="CoreCompile">
    <ItemGroup>
      <EmbedInBinlog Include="@(Compile)" Condition="$([System.String]::new('%(Identity)').Contains('Shared/'))"/>
    </ItemGroup>
  </Target>

</Project>
