<Project>
  <PropertyGroup>
    <IsPackable>false</IsPackable>
  </PropertyGroup>

  <!-- Add implicit using for xunit (via Target for correct timing - items require Target) -->
  <Target Name="_InjectXunitUsings" BeforeTargets="BeforeBuild;CollectPackageReferences" DependsOnTargets="_DetectTestFrameworksAndMTP" Condition="'$(ImplicitUsings)' == 'enable'">
    <!-- Filter xUnit packages using correct MSBuild syntax -->
    <ItemGroup>
      <_XunitUsings Include="@(PackageReference)" Condition="'%(Identity)' == 'xunit'"/>
      <_XunitUsings Include="@(PackageReference)" Condition="'%(Identity)' == 'xunit.v3'"/>
      <_XunitUsings Include="@(PackageReference)" Condition="'%(Identity)' == 'xunit.v3.mtp-v1'"/>
      <_XunitUsings Include="@(PackageReference)" Condition="'%(Identity)' == 'xunit.v3.mtp-v2'"/>
    </ItemGroup>
    <ItemGroup Condition="'@(_XunitUsings)' != ''">
      <Using Include="Xunit"/>
    </ItemGroup>
  </Target>

  <!-- ═══════════════════════════════════════════════════════════════════════
       TEST EXTENSIONS (Auto-injected for test projects)
       ═══════════════════════════════════════════════════════════════════════ -->

  <!-- GitHub Actions Test Reporting (via Target for correct timing) -->
  <Target Name="_InjectGitHubActionsLogger" BeforeTargets="BeforeBuild;Restore;CollectPackageReferences" DependsOnTargets="_DetectTestFrameworksAndMTP" Condition="'$(_IsGitHubActions)' == 'true'">
    <!-- MTP: GitHubActionsTestLogger auto-registers -->
    <ItemGroup>
      <PackageReference Include="GitHubActionsTestLogger" Version="$(GitHubActionsLoggerMTPVersion)" VersionOverride="$(GitHubActionsLoggerMTPVersion)" IsImplicitlyDefined="true"/>
    </ItemGroup>
  </Target>

</Project>