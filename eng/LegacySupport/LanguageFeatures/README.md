# Language Feature Polyfills

This directory provides polyfills for various C# language features, allowing their use in projects targeting older .NET
frameworks where these features might not be natively supported.

## Usage

To inject these language feature polyfills into your project, set the following property in your `.csproj` file:

```xml
<PropertyGroup>
  <InjectANcpLuaLanguageFeaturesPolyfills>true</InjectANcpLuaLanguageFeaturesPolyfills>
</PropertyGroup>
```

## What gets injected

Reference only: the following C# is shown just to illustrate how the injected code looks.
You do not copy/paste or add these files manually.

<details> <summary><code>CallerArgumentExpressionAttribute.cs</code> (injected)</summary>

```csharp
// <auto-generated/>
#nullable enable
// Copyright (c) Microsoft. All rights reserved.

using System.Diagnostics.CodeAnalysis;

namespace System.Runtime.CompilerServices;

/// <summary>
/// Tags parameter that should be filled with specific caller name.
/// </summary>
[AttributeUsage(AttributeTargets.Parameter, AllowMultiple = false, Inherited = false)]
[ExcludeFromCodeCoverage]
internal sealed class CallerArgumentExpressionAttribute : Attribute
{
    /// <summary>
    /// Initializes a new instance of the <see cref="CallerArgumentExpressionAttribute"/> class.
    /// </summary>
    /// <param name="parameterName">Function parameter to take the name from.</param>
    public CallerArgumentExpressionAttribute(string parameterName)
    {
        this.ParameterName = parameterName;
    }

    /// <summary>
    /// Gets name of the function parameter that name should be taken from.
    /// </summary>
    public string ParameterName { get; }
}
```

</details>

<details> <summary><code>CompilerFeatureRequiredAttribute.cs</code> (injected)</summary>

```csharp
// <auto-generated/>
#nullable enable
// Copyright (c) Microsoft. All rights reserved.

#pragma warning disable SA1623 // Property summary documentation should match accessors

namespace System.Runtime.CompilerServices;

/// <summary>
/// Indicates that compiler support for a particular feature is required for the location where this attribute is applied.
/// </summary>
[AttributeUsage(AttributeTargets.All, AllowMultiple = true, Inherited = false)]
internal sealed class CompilerFeatureRequiredAttribute : Attribute
{
    public CompilerFeatureRequiredAttribute(string featureName)
    {
        this.FeatureName = featureName;
    }

    /// <summary>
    /// The name of the compiler feature.
    /// </summary>
    public string FeatureName { get; }

    /// <summary>
    /// If true, the compiler can choose to allow access to the location where this attribute is applied if it does not understand <see cref="FeatureName"/>.
    /// </summary>
    public bool IsOptional { get; set; }

    /// <summary>
    /// The <see cref="FeatureName"/> used for the ref structs C# feature.
    /// </summary>
    public const string RefStructs = nameof(RefStructs);

    /// <summary>
    /// The <see cref="FeatureName"/> used for the required members C# feature.
    /// </summary>
    public const string RequiredMembers = nameof(RequiredMembers);
}
```

</details>

<details> <summary><code>IsExternalInit.cs</code> (injected)</summary>

```csharp
// <auto-generated/>
#nullable enable
// Copyright (c) ANcpLua. All rights reserved.
// Licensed under the MIT License.

// Enables C# 9 record types on older frameworks (netstandard2.0, net48, etc.)

namespace System.Runtime.CompilerServices
{
    internal static class IsExternalInit { }
}
```

</details>

<details> <summary><code>ParamCollectionAttribute.cs</code> (injected)</summary>

```csharp
// <auto-generated/>
#nullable enable
// Copyright (c) ANcpLua. All rights reserved.
// Licensed under the MIT License.

using System;
using System.Diagnostics.CodeAnalysis;

#if !NET9_0_OR_GREATER

namespace System.Runtime.CompilerServices
{
    /// <summary>
    ///     Indicates that a method will allow a variable number of arguments in its invocation.
    /// </summary>
    /// <remarks>
    ///     This attribute is required for C# 13 params collections feature on older TFMs.
    /// </remarks>
    [AttributeUsage(AttributeTargets.Parameter)]
    [ExcludeFromCodeCoverage]
    internal sealed class ParamCollectionAttribute : Attribute
    {
    }
}

#endif
```

</details>

<details> <summary><code>RequiredMemberAttribute.cs</code> (injected)</summary>

```csharp
// <auto-generated/>
#nullable enable
// Copyright (c) Microsoft. All rights reserved.

using System.ComponentModel;

namespace System.Runtime.CompilerServices;

/// <summary>Specifies that a type has required members or that a member is required.</summary>
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Struct | AttributeTargets.Field | AttributeTargets.Property, AllowMultiple = false, Inherited = false)]
[EditorBrowsable(EditorBrowsableState.Never)]
internal sealed class RequiredMemberAttribute : Attribute;
```

</details>